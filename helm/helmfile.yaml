repositories:
  - name: jetstack
    url: https://charts.jetstack.io
  - name: traefik
    url: https://helm.traefik.io/traefik

helmfiles:
  - ./cloudflare/helmfile.yaml

releases:
  - name: traefik
    namespace: traefik
    createNamespace: true
    chart: traefik/traefik
    version: v35.2.0
    values:
      - service:
          spec:
            loadBalancerIP: 192.168.1.220
        ingressClass:
          enabled: true
          isDefaultClass: true
        ports:
          web:
            redirections:
              entryPoint:
                to: websecure
                scheme: https
                permanent: true
          websecure:
            tls:
              enabled: true
  - name: nginx
    namespace: nginx
    createNamespace: true
    chart: ./charts/nginx
    values:
      - helm.secret.yaml
      - service:
          port: 80
        clusterIssuer:
          name: cluster-issuer
